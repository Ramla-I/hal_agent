**General-purpose timers (TIM12/13/14)** **RM0041**

# **14 General-purpose timers (TIM12/13/14)**


**Low-density value line devices** are STM32F100xx microcontrollers where the flash
memory density ranges between 16 and 32 Kbytes.


**Medium-density value line devices** are STM32F100xx microcontrollers where the flash
memory density ranges between 64 and 128 Kbytes.


**High-density value line devices** are STM32F100xx microcontrollers where the flash
memory density ranges between 256 Kbytes and 1 Mbyte.


This section applies to _high density value line devices only_ .

## **14.1 TIM12/13/14 introduction**


The TIM12/13/14 general-purpose timers consist of a 16-bit auto-reload counter driven by a
programmable prescaler.


They may be used for a variety of purposes, including measuring the pulse lengths of input
signals (input capture) or generating output waveforms (output compare, PWM).


Pulse lengths and waveform periods can be modulated from a few microseconds to several
milliseconds using the timer prescaler and the RCC clock controller prescalers.


The TIM12/13/14 timers are completely independent, and do not share any resources. They
can be synchronized together as described in _Section 14.3.12_ .

## **14.2 TIM12/13/14 main features**


**14.2.1** **TIM12 main features**


The features of the general-purpose timer include:


      - 16-bit auto-reload upcounter


      - 16-bit programmable prescaler used to divide the counter clock frequency by any factor
between 1 and 65536 (can be changed “on the fly”)


      - Up to 2 independent channels for:


–
Input capture


–
Output compare


–
PWM generation (edge-aligned mode)


–
One-pulse mode output


      - Synchronization circuit to control the timer with external signals and to interconnect
several timers together


      - Interrupt generation on the following events:


–
Update: counter overflow, counter initialization (by software or internal trigger)


–
Trigger event (counter start, stop, initialization or count by internal trigger)


–
Input capture


–
Output compare


342/709 RM0041 Rev 6


**RM0041** **General-purpose timers (TIM12/13/14)**


**Figure 134. General-purpose timer block diagram (TIM12)**

































































**14.2.2** **TIM13/TIM14 main features**


The features of general-purpose timers TIM13/TIM14 include:


      - 16-bit auto-reload upcounter




- 16-bit programmable prescaler used to divide the counter clock frequency by any factor
between 1 and 65536 (can be changed “on the fly”)


- independent channel for:


–
Input capture


–
Output compare


–
PWM generation (edge-aligned mode)


–
One-pulse mode output


- Interrupt generation on the following events:


–
Update: counter overflow, counter initialization (by software)


–
Input capture


–
Output compare


RM0041 Rev 6 343/709



455


**General-purpose timers (TIM12/13/14)** **RM0041**


**Figure 135. General-purpose timer block diagram (TIM13/14)**

































344/709 RM0041 Rev 6


**RM0041** **General-purpose timers (TIM12/13/14)**

## **14.3 TIM12/13/14 functional description**


**14.3.1** **Time-base unit**


The main block of the timer is a 16-bit counter with its related auto-reload register. The
counters counts up.


The counter clock can be divided by a prescaler.


The counter, the auto-reload register and the prescaler register can be written or read by
software. This is true even when the counter is running.


The time-base unit includes:


      - Counter register (TIMx_CNT)


      - Prescaler register (TIMx_PSC)


      - Auto-reload register (TIMx_ARR)


The auto-reload register is preloaded. Writing to or reading from the auto-reload register
accesses the preload register. The content of the preload register are transferred into the
shadow register permanently or at each update event (UEV), depending on the auto-reload
preload enable bit (ARPE) in TIMx_CR1 register. The update event is sent when the counter
reaches the overflow and if the UDIS bit equals 0 in the TIMx_CR1 register. It can also be
generated by software. The generation of the update event is described in details for each
configuration.


The counter is clocked by the prescaler output CK_CNT, which is enabled only when the
counter enable bit (CEN) in TIMx_CR1 register is set (refer also to the slave mode controller
description to get more details on counter enabling).


Note that the counter starts counting 1 clock cycle after setting the CEN bit in the TIMx_CR1
register.


**Prescaler description**


The prescaler can divide the counter clock frequency by any factor between 1 and 65536. It
is based on a 16-bit counter controlled through a 16-bit register (in the TIMx_PSC register).
It can be changed on the fly as this control register is buffered. The new prescaler ratio is
taken into account at the next update event.


_Figure 136_ and _Figure 137_ give some examples of the counter behavior when the prescaler
ratio is changed on the fly.


RM0041 Rev 6 345/709



455


**General-purpose timers (TIM12/13/14)** **RM0041**


**Figure 136. Counter timing diagram with prescaler division change from 1 to 2**







|Col1|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|Col10|Col11|Col12|Col13|Col14|
|---|---|---|---|---|---|---|---|---|---|---|---|---|---|
|F8|F9|FA|FB|FC|00|00|01|01|02|02|02|03|03|
|F8|F9|FA|FB|FC||||||||||
|F8||||||||||||||
|F8||||||||||||||
|F8||||||||||||||
|F8||||||||||||||
|F8|||||0|1|0|1|0|1|0|0|1|


**Figure 137. Counter timing diagram with prescaler division change from 1 to 4**












|Col1|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|Col10|Col11|Col12|Col13|Col14|
|---|---|---|---|---|---|---|---|---|---|---|---|---|---|
|F8|F8|F9|FA|FB|FC|00|00|00|00|00|00|00|00|
|F8|F8|F9|FA|FB|FC|||||||||
|F8||||||||||||||
|F8||||||||||||||
|F8||||||||||||||
|F8||||||||||||||
|F8||||||0|1|2|3|0|1|2|3|



346/709 RM0041 Rev 6


**RM0041** **General-purpose timers (TIM12/13/14)**


**14.3.2** **Counter modes**


**Upcounting mode**


In upcounting mode, the counter counts from 0 to the auto-reload value (content of the
TIMx_ARR register), then restarts from 0 and generates a counter overflow event.


Setting the UG bit in the TIMx_EGR register (by software or by using the slave mode
controller on TIM12) also generates an update event.


The UEV event can be disabled by software by setting the UDIS bit in the TIMx_CR1
register. This is to avoid updating the shadow registers while writing new values in the
preload registers. Then no update event occurs until the UDIS bit has been written to 0.
However, the counter restarts from 0, as well as the counter of the prescaler (but the
prescale rate does not change). In addition, if the URS bit (update request selection) in
TIMx_CR1 register is set, setting the UG bit generates an update event UEV but without
setting the UIF flag (thus no interrupt is sent). This is to avoid generating both update and
capture interrupts when clearing the counter on the capture event.


When an update event occurs, all the registers are updated and the update flag (UIF bit in
TIMx_SR register) is set (depending on the URS bit):


      - The auto-reload shadow register is updated with the preload value (TIMx_ARR),


      - The buffer of the prescaler is reloaded with the preload value (content of the TIMx_PSC
register).


The following figures show some examples of the counter behavior for different clock
frequencies when TIMx_ARR=0x36.


**Figure 138. Counter timing diagram, internal clock divided by 1**





|Col1|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|Col10|Col11|Col12|Col13|
|---|---|---|---|---|---|---|---|---|---|---|---|---|
|32|33|34|35|36|00|01|02|03|04|05|06|07|


RM0041 Rev 6 347/709



455


**General-purpose timers (TIM12/13/14)** **RM0041**


**Figure 139. Counter timing diagram, internal clock divided by 2**







**Figure 140. Counter timing diagram, internal clock divided by 4**







**Figure 141. Counter timing diagram, internal clock divided by N**









348/709 RM0041 Rev 6


**RM0041** **General-purpose timers (TIM12/13/14)**


**Figure 142. Counter timing diagram, update event when ARPE=0 (TIMx_ARR not**
**preloaded)**






|Col1|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|Col10|Col11|Col12|Col13|
|---|---|---|---|---|---|---|---|---|---|---|---|---|
|32|33|34|35|36|00|01|02|03|04|05|06|07|





**Figure 143. Counter timing diagram, update event when ARPE=1 (TIMx_ARR**
**preloaded)**






|Col1|Col2|Col3|Col4|Col5|Col6|Col7|Col8|
|---|---|---|---|---|---|---|---|
|F1|F2|F3|F4|F5|00|01|02|









RM0041 Rev 6 349/709



455


**General-purpose timers (TIM12/13/14)** **RM0041**


**14.3.3** **Clock selection**


The counter clock can be provided by the following clock sources:


      - Internal clock (CK_INT)


      - External clock mode1 (for **TIM1** 2): external input pin (TIx)


      - Internal trigger inputs (ITRx) (for **TIM1** 2): connecting the trigger output from another
timer. Refer to _Using one timer as prescaler for another timer_ for more details.


**Internal clock source (CK_INT)**


The internal clock source is the default clock source for TIM13/TIM14.


For TIM9, the internal clock source is selected when the slave mode controller is disabled
(SMS=’000’). The CEN bit in the TIMx_CR1 register and the UG bit in the TIMx_EGR
register are then used as control bits and can be changed only by software (except for UG
which remains cleared). As soon as the CEN bit is programmed to 1, the prescaler is
clocked by the internal clock CK_INT.


_Figure 144_ shows the behavior of the control circuit and of the upcounter in normal mode,
without prescaler.


**Figure 144. Control circuit in normal mode, internal clock divided by 1**






|Col1|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|Col10|Col11|Col12|Col13|Col14|
|---|---|---|---|---|---|---|---|---|---|---|---|---|---|
|||||||||||||||
|||||||||||||||
|||||||||||||||
|31|3 2|33|34|35|36|00|01|02|03|04|05|06|07|



**External clock source mode 1(** **TIM1** **2** **)**


This mode is selected when SMS=’111’ in the TIMx_SMCR register. The counter can count
at each rising or falling edge on a selected input.


350/709 RM0041 Rev 6


**RM0041** **General-purpose timers (TIM12/13/14)**


**Figure 145. TI2 external clock connection example**



































For example, to configure the upcounter to count in response to a rising edge on the TI2
input, use the following procedure:


1. Configure channel 2 to detect rising edges on the TI2 input by writing CC2S = ‘01’ in
the TIMx_CCMR1 register.


2. Configure the input filter duration by writing the IC2F[3:0] bits in the TIMx_CCMR1
register (if no filter is needed, keep IC2F=’0000’).


3. Select the rising edge polarity by writing CC2P=’0’ and CC2NP=’0’ in the TIMx_CCER
register.


4. Configure the timer in external clock mode 1 by writing SMS=’111’ in the TIMx_SMCR
register.


5. Select TI2 as the trigger input source by writing TS=’110’ in the TIMx_SMCR register.


6. Enable the counter by writing CEN=’1’ in the TIMx_CR1 register.


_Note:_ _The capture prescaler is not used for triggering, so no need to configure it._


When a rising edge occurs on TI2, the counter counts once and the TIF flag is set.


The delay between the rising edge on TI2 and the actual clock of the counter is due to the
resynchronization circuit on TI2 input.


**Figure 146. Control circuit in external clock mode 1**


RM0041 Rev 6 351/709



455


**General-purpose timers (TIM12/13/14)** **RM0041**


**14.3.4** **Capture/compare channels**


Each Capture/Compare channel is built around a capture/compare register (including a
shadow register), a input stage for capture (with digital filter, multiplexing and prescaler) and
an output stage (with comparator and output control).


_Figure 147_ to _Figure 149_ give an overview of a capture/compare channel.


The input stage samples the corresponding TIx input to generate a filtered signal TIxF.
Then, an edge detector with polarity selection generates a signal (TIxFPx) which can be
used as trigger input by the slave mode controller or as the capture command. It is
prescaled before the capture register (ICxPS).


**Figure 147. Capture/compare channel (example: channel 1 input stage)**















































The output stage generates an intermediate waveform which is then used for reference:
OCxRef (active high). The polarity acts at the end of the chain.


352/709 RM0041 Rev 6


**RM0041** **General-purpose timers (TIM12/13/14)**


**Figure 148. Capture/compare channel 1 main circuit**









































**Figure 149. Output stage of capture/compare channel (channel 1)**





















The capture/compare block is made of one preload register and one shadow register. Write
and read always access the preload register.


In capture mode, captures are actually done in the shadow register, which is copied into the
preload register.



In compare mode, the content of the preload register is copied into the shadow register
which is compared to the counter.



**14.3.5** **Input capture mode**


In Input capture mode, the Capture/Compare registers (TIMx_CCRx) are used to latch the
value of the counter after a transition detected by the corresponding ICx signal. When a
capture occurs, the corresponding CCXIF flag (TIMx_SR register) is set and an interrupt or
a DMA request can be sent if they are enabled. If a capture occurs while the CCxIF flag was
already high, then the over-capture flag CCxOF (TIMx_SR register) is set. CCxIF can be



RM0041 Rev 6 353/709



455


**General-purpose timers (TIM12/13/14)** **RM0041**


cleared by software by writing it to ‘0’ or by reading the captured data stored in the
TIMx_CCRx register. CCxOF is cleared when the user writes it to ‘0’.


The following example shows how to capture the counter value in TIMx_CCR1 when TI1
input rises. To do this, use the following procedure:


1. Select the active input: TIMx_CCR1 must be linked to the TI1 input, so write the CC1S
bits to ‘01’ in the TIMx_CCMR1 register. As soon as CC1S becomes different from ‘00’,
the channel is configured in input mode and the TIMx_CCR1 register becomes readonly.


2. Program the needed input filter duration with respect to the signal connected to the
timer (by programming the ICxF bits in the TIMx_CCMRx register if the input is one of
the TIx inputs). Let’s imagine that, when toggling, the input signal is not stable during at
must 5 internal clock cycles. We must program a filter duration longer than these 5
clock cycles. We can validate a transition on TI1 when 8 consecutive samples with the
new level have been detected (sampled at f DTS frequency). Then write IC1F bits to
‘0011’ in the TIMx_CCMR1 register.


3. Select the edge of the active transition on the TI1 channel by programming CC1P and
CC1NP bits to ‘00’ in the TIMx_CCER register (rising edge in this case).


4. Program the input prescaler. In our example, we wish the capture to be performed at
each valid transition, so the prescaler is disabled (write IC1PS bits to ‘00’ in the
TIMx_CCMR1 register).


5. Enable capture from the counter into the capture register by setting the CC1E bit in the
TIMx_CCER register.


6. If needed, enable the related interrupt request by setting the CC1IE bit in the
TIMx_DIER register.


When an input capture occurs:


      - The TIMx_CCR1 register gets the value of the counter on the active transition.


      - CC1IF flag is set (interrupt flag). CC1OF is also set if at least two consecutive captures
occurred whereas the flag was not cleared.


      - An interrupt is generated depending on the CC1IE bit.


In order to handle the overcapture, it is recommended to read the data before the
overcapture flag. This is to avoid missing an overcapture which could happen after reading
the flag and before reading the data.


_Note:_ _IC interrupt requests can be generated by software by setting the corresponding CCxG bit in_
_the TIMx_EGR register._


354/709 RM0041 Rev 6


**RM0041** **General-purpose timers (TIM12/13/14)**


**14.3.6** **PWM input mode (only for TIM12)**


This mode is a particular case of input capture mode. The procedure is the same except:


      - Two ICx signals are mapped on the same TIx input.


      - These 2 ICx signals are active on edges with opposite polarity.


      - One of the two TIxFP signals is selected as trigger input and the slave mode controller
is configured in reset mode.


For example, the user can measure the period (in TIMx_CCR1 register) and the duty cycle
(in TIMx_CCR2 register) of the PWM applied on TI1 using the following procedure
(depending on CK_INT frequency and prescaler value):


1. Select the active input for TIMx_CCR1: write the CC1S bits to ‘01’ in the TIMx_CCMR1
register (TI1 selected).


2. Select the active polarity for TI1FP1 (used both for capture in TIMx_CCR1 and counter
clear): program the CC1P and CC1NP bits to ‘00’ (active on rising edge).


3. Select the active input for TIMx_CCR2: write the CC2S bits to ‘10’ in the TIMx_CCMR1
register (TI1 selected).


4. Select the active polarity for TI1FP2 (used for capture in TIMx_CCR2): write the CC2P
bit to '1' and the CC2NP bit to '0' (active on falling edge).


5. Select the valid trigger input: write the TS bits to ‘101’ in the TIMx_SMCR register
(TI1FP1 selected).


6. Configure the slave mode controller in reset mode: write the SMS bits to ‘100’ in the
TIMx_SMCR register.


7. Enable the captures: write the CC1E and CC2E bits to ‘1’ in the TIMx_CCER register.


**Figure 150. PWM input mode timing**











1. The PWM input mode can be used only with the TIMx_CH1/TIMx_CH2 signals due to the fact that only
TI1FP1 and TI2FP2 are connected to the slave mode controller.


RM0041 Rev 6 355/709



455


**General-purpose timers (TIM12/13/14)** **RM0041**


**14.3.7** **Forced output mode**


In output mode (CCxS bits = ‘00’ in the TIMx_CCMRx register), each output compare signal
(OCxREF and then OCx) can be forced to active or inactive level directly by software,
independently of any comparison between the output compare register and the counter.


To force an output compare signal (OCXREF/OCx) to its active level, the user just needs to
write ‘101’ in the OCxM bits in the corresponding TIMx_CCMRx register. Thus OCXREF is
forced high (OCxREF is always active high) and OCx get opposite value to CCxP polarity
bit.


For example: CCxP=’0’ (OCx active high) => OCx is forced to high level.


The OCxREF signal can be forced low by writing the OCxM bits to ‘100’ in the
TIMx_CCMRx register.


Anyway, the comparison between the TIMx_CCRx shadow register and the counter is still
performed and allows the flag to be set. Interrupt requests can be sent accordingly. This is
described in the output compare mode section below.


**14.3.8** **Output compare mode**


This function is used to control an output waveform or indicating when a period of time has
elapsed.


When a match is found between the capture/compare register and the counter, the output
compare function:


1. Assigns the corresponding output pin to a programmable value defined by the output
compare mode (OCxM bits in the TIMx_CCMRx register) and the output polarity (CCxP
bit in the TIMx_CCER register). The output pin can keep its level (OCXM=’000’), be set
active (OCxM=’001’), be set inactive (OCxM=’010’) or can toggle (OCxM=’011’) on
match.


2. Sets a flag in the interrupt status register (CCxIF bit in the TIMx_SR register).


3. Generates an interrupt if the corresponding interrupt mask is set (CCXIE bit in the
TIMx_DIER register).


The TIMx_CCRx registers can be programmed with or without preload registers using the
OCxPE bit in the TIMx_CCMRx register.


In output compare mode, the update event UEV has no effect on OCxREF and OCx output.
The timing resolution is one count of the counter. Output compare mode can also be used to
output a single pulse (in One-pulse mode).


Procedure:


1. Select the counter clock (internal, external, prescaler).


2. Write the desired data in the TIMx_ARR and TIMx_CCRx registers.


3. Set the CCxIE bit if an interrupt request is to be generated.


4. Select the output mode. For example:


–
Write OCxM = ‘011’ to toggle OCx output pin when CNT matches CCRx


–
Write OCxPE = ‘0’ to disable preload register


–
Write CCxP = ‘0’ to select active high polarity


–
Write CCxE = ‘1’ to enable the output


5. Enable the counter by setting the CEN bit in the TIMx_CR1 register.


356/709 RM0041 Rev 6


**RM0041** **General-purpose timers (TIM12/13/14)**


The TIMx_CCRx register can be updated at any time by software to control the output
waveform, provided that the preload register is not enabled (OCxPE=’0’, else TIMx_CCRx
shadow register is updated only at the next update event UEV). An example is given in
_Figure 151_ .


**Figure 151. Output compare mode, toggle on OC1.**









**14.3.9** **PWM mode**









Pulse Width Modulation mode allows the user to generate a signal with a frequency
determined by the value of the TIMx_ARR register and a duty cycle determined by the value
of the TIMx_CCRx register.


The PWM mode can be selected independently on each channel (one PWM per OCx
output) by writing ‘110’ (PWM mode 1) or ‘111’ (PWM mode 2) in the OCxM bits in the
TIMx_CCMRx register. Enable the corresponding preload register by setting the OCxPE bit
in the TIMx_CCMRx register, and eventually the auto-reload preload register by setting the
ARPE bit in the TIMx_CR1 register.


As the preload registers are transferred to the shadow registers only when an update event
occurs, before starting the counter, the user has to initialize all the registers by setting the
UG bit in the TIMx_EGR register.


The OCx polarity is software programmable using the CCxP bit in the TIMx_CCER register.
It can be programmed as active high or active low. The OCx output is enabled by the CCxE
bit in the TIMx_CCER register. Refer to the TIMx_CCERx register description for more
details.


In PWM mode (1 or 2), TIMx_CNT and TIMx_CCRx are always compared to determine
whether TIMx_CNT ≤TIMx_CCRx.


The timer is able to generate PWM in edge-aligned mode only since the counter is
upcounting.


**PWM edge-aligned mode**


In the following example, we consider PWM mode 1. The reference PWM signal OCxREF is
high as long as TIMx_CNT < TIMx_CCRx else it becomes low. If the compare value in


RM0041 Rev 6 357/709



455


**General-purpose timers (TIM12/13/14)** **RM0041**


TIMx_CCRx is greater than the auto-reload value (in TIMx_ARR) then OCxREF is held at
‘1’. If the compare value is 0 then OCxRef is held at ‘0’. _Figure 152_ shows some edgealigned PWM waveforms in an example where TIMx_ARR=8.


**Figure 152. Edge-aligned PWM waveforms (ARR=8)**



**14.3.10** **One-pulse mode**




|0|1|2|3|4|5|
|---|---|---|---|---|---|
|||||||
|||||||


|Col1|7|8|0|1|
|---|---|---|---|---|
||7||||
||||||
||||||
||||||







One-pulse mode (OPM) is a particular case of the previous modes. It allows the counter to
be started in response to a stimulus and to generate a pulse with a programmable length
after a programmable delay.


Starting the counter can be controlled through the slave mode controller. Generating the
waveform can be done in output compare mode or PWM mode. Select One-pulse mode by
setting the OPM bit in the TIMx_CR1 register. This makes the counter stop automatically at
the next update event UEV.


A pulse can be correctly generated only if the compare value is different from the counter
initial value. Before starting (when the timer is waiting for the trigger), the configuration must
be as follows:


CNT < CCRx≤ ARR (in particular, 0 < CCRx)


358/709 RM0041 Rev 6


**RM0041** **General-purpose timers (TIM12/13/14)**


**Figure 153. Example of one pulse mode.**







For example the user may want to generate a positive pulse on OC1 with a length of t PULSE
and after a delay of t DELAY as soon as a positive edge is detected on the TI2 input pin.


Use TI2FP2 as trigger 1:


1. Map TI2FP2 to TI2 by writing CC2S=’01’ in the TIMx_CCMR1 register.


2. TI2FP2 must detect a rising edge, write CC2P=’0’ and CC2NP = ‘0’ in the TIMx_CCER
register.


3. Configure TI2FP2 as trigger for the slave mode controller (TRGI) by writing TS=’110’ in
the TIMx_SMCR register.


4. TI2FP2 is used to start the counter by writing SMS to ‘110’ in the TIMx_SMCR register
(trigger mode).


The OPM waveform is defined by writing the compare registers (taking into account the
clock frequency and the counter prescaler).


- The t DELAY is defined by the value written in the TIMx_CCR1 register.


- The t PULSE is defined by the difference between the auto-reload value and the compare
value (TIMx_ARR - TIMx_CCR1).


- Let us say the user wants to build a waveform with a transition from ‘0’ to ‘1’ when a
compare match occurs and a transition from ‘1’ to ‘0’ when the counter reaches the
auto-reload value. To do this enable PWM mode 2 by writing OC1M=’111’ in the
TIMx_CCMR1 register. The user can optionally enable the preload registers by writing
OC1PE=’1’ in the TIMx_CCMR1 register and ARPE in the TIMx_CR1 register. In this
case the user has to write the compare value in the TIMx_CCR1 register, the autoreload value in the TIMx_ARR register, generate an update by setting the UG bit and
wait for external trigger event on TI2. CC1P is written to ‘0’ in this example.


The user only wants one pulse (Single mode), so write '1 in the OPM bit in the TIMx_CR1
register to stop the counter at the next update event (when the counter rolls over from the
auto-reload value back to 0). When OPM bit in the TIMx_CR1 register is set to '0', so the
Repetitive mode is selected.


RM0041 Rev 6 359/709



455


**General-purpose timers (TIM12/13/14)** **RM0041**


**Particular case: OCx fast enable**


In One-pulse mode, the edge detection on TIx input set the CEN bit which enables the
counter. Then the comparison between the counter and the compare value makes the
output toggle. But several clock cycles are needed for these operations and it limits the
minimum delay t DELAY min we can get.


If the user wants to output a waveform with the minimum delay, set the OCxFE bit in the
TIMx_CCMRx register. Then OCxRef (and OCx) are forced in response to the stimulus,
without taking in account the comparison. Its new level is the same as if a compare match
had occurred. OCxFE acts only if the channel is configured in PWM1 or PWM2 mode.


**14.3.11** **TIM12 external trigger synchronization**


The TIM12 timer can be synchronized with an external trigger in several modes: Reset
mode, Gated mode and Trigger mode.


**Slave mode: Reset mode**


The counter and its prescaler can be reinitialized in response to an event on a trigger input.
Moreover, if the URS bit from the TIMx_CR1 register is low, an update event UEV is
generated. Then all the preloaded registers (TIMx_ARR, TIMx_CCRx) are updated.


In the following example, the upcounter is cleared in response to a rising edge on TI1 input:


1. Configure the channel 1 to detect rising edges on TI1. Configure the input filter duration
(in this example, no need of any filter, IC1F = 0000 kept). The capture prescaler is not
used for triggering, so there’s no need to configure it. The CC1S bits select the input
capture source only, CC1S = ‘01’ in the TIMx_CCMR1 register. Program CC1P and
CC1NP to ‘00’ in TIMx_CCER register to validate the polarity (and detect rising edges
only).


2. Configure the timer in reset mode by writing SMS=’100’ in TIMx_SMCR register. Select
TI1 as the input source by writing TS=’101’ in TIMx_SMCR register.


3. Start the counter by writing CEN=’1’ in the TIMx_CR1 register.


The counter starts counting on the internal clock, then behaves normally until TI1 rising
edge. When TI1 rises, the counter is cleared and restarts from 0. In the meantime, the
trigger flag is set (TIF bit in the TIMx_SR register) and an interrupt request can be sent if
enabled (depending on the TIE bit in TIMx_DIER register).


The following figure shows this behavior when the auto-reload register TIMx_ARR=0x36.
The delay between the rising edge on TI1 and the actual reset of the counter is due to the
resynchronization circuit on TI1 input.


360/709 RM0041 Rev 6


**RM0041** **General-purpose timers (TIM12/13/14)**


**Figure 154. Control circuit in reset mode**








|Col1|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|Col10|Col11|Col12|Col13|Col14|Col15|
|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|
|30|31|32|33|34|35|36|00|01|02|03|00|01|02|03|



**Slave mode: Gated mode**


The counter can be enabled depending on the level of a selected input.


In the following example, the upcounter counts only when TI1 input is low:





1. Configure the channel 1 to detect low levels on TI1. Configure the input filter duration
(in this example, no need of any filter, IC1F=’0000’ kept). The capture prescaler is not
used for triggering, so there’s no need to configure it. The CC1S bits select the input
capture source only, CC1S=’01’ in TIMx_CCMR1 register. Program CC1P=’1’ and
CC1NP= ‘0’ in TIMx_CCER register to validate the polarity (and detect low level only).


2. Configure the timer in gated mode by writing SMS=’101’ in TIMx_SMCR register.
Select TI1 as the input source by writing TS=’101’ in TIMx_SMCR register.


3. Enable the counter by writing CEN=’1’ in the TIMx_CR1 register (in gated mode, the
counter does not start if CEN=’0’, whatever is the trigger input level).


The counter starts counting on the internal clock as long as TI1 is low and stops as soon as
TI1 becomes high. The TIF flag in the TIMx_SR register is set both when the counter starts
or stops.


The delay between the rising edge on TI1 and the actual stop of the counter is due to the
resynchronization circuit on TI1 input.


RM0041 Rev 6 361/709



455


**General-purpose timers (TIM12/13/14)** **RM0041**


**Figure 155. Control circuit in gated mode**







**Slave mode: Trigger mode**







The counter can start in response to an event on a selected input.


In the following example, the upcounter starts in response to a rising edge on TI2 input:


1. Configure the channel 2 to detect rising edges on TI2. Configure the input filter duration
(in this example, no need of any filter, IC2F=’0000’ kept). The capture prescaler is not
used for triggering, so there’s no need to configure it. The CC2S bits are configured to
select the input capture source only, CC2S=’01’ in TIMx_CCMR1 register. Program
CC2P=’1’ and CC2NP=’0’ in TIMx_CCER register to validate the polarity (and detect
low level only).


2. Configure the timer in trigger mode by writing SMS=’110’ in TIMx_SMCR register.
Select TI2 as the input source by writing TS=’110’ in TIMx_SMCR register.


When a rising edge occurs on TI2, the counter starts counting on the internal clock and the
TIF flag is set.


The delay between the rising edge on TI2 and the actual start of the counter is due to the
resynchronization circuit on TI2 input.


**Figure 156. Control circuit in trigger mode**







362/709 RM0041 Rev 6




**RM0041** **General-purpose timers (TIM12/13/14)**


**14.3.12** **Timer synchronization (TIM12)**


The TIM timers are linked together internally for timer synchronization or chaining. Refer to
_Section 13.3.15: Timer synchronization_ for details.


_Note:_ _The clock of the slave timer must be enabled prior to receive events from the master timer,_
_and must not be changed on-the-fly while triggers are received from the master timer._


**14.3.13** **Debug mode**


When the microcontroller enters debug mode (Cortex [®] -M3 core halted), the TIMx counter
either continues to work normally or stops, depending on DBG_TIMx_STOP configuration
bit in DBG module. For more details, refer to _Section 25.15.2: Debug support for timers,_
_watchdog and I_ _[2]_ _C_ .


RM0041 Rev 6 363/709



455


**General-purpose timers (TIM12/13/14)** **RM0041**

## **14.4 TIM12 registers**


Refer to _Section 2.2_ for a list of abbreviations used in register descriptions.


The peripheral registers have to be written by half-words (16 bits) or words (32 bits). Read
accesses can be done by bytes (8 bits), half-words (16 bits) or words (32 bits).


**14.4.1** **TIM12 control register 1 (TIMx_CR1)**


Address offset: 0x00


Reset value: 0x0000

|15 14 13 12 11 10|9 8|Col3|7|6 5 4|3|2|1|0|
|---|---|---|---|---|---|---|---|---|
|Reserved|CKD[1:0]|CKD[1:0]|ARPE|Reserved|OPM|URS|UDIS|CEN|
|Reserved|rw|rw|rw|rw|rw|rw|rw|rw|



Bits 15:10 Reserved, must be kept at reset value.


Bits 9:8 **CKD** : Clock division

This bit-field indicates the division ratio between the timer clock (CK_INT) frequency and
sampling clock used by the digital filters (TIx),
00: t DTS = t CK_INT
01: t DTS = 2 × t CK_INT
10: t DTS = 4 × t CK_INT
11: Reserved


Bit 7 **ARPE** : Auto-reload preload enable

0: TIMx_ARR register is not buffered.
1: TIMx_ARR register is buffered.


Bits 6:4 Reserved, must be kept at reset value.


Bit 3 **OPM** : One-pulse mode

0: Counter is not stopped on the update event
1: Counter stops counting on the next update event (clearing the CEN bit).


Bit 2 **URS** : Update request source

This bit is set and cleared by software to select the UEV event sources.
0: Any of the following events generates an update interrupt if enabled:

– Counter overflow

–
Setting the UG bit
1: Only counter overflow generates an update interrupt if enabled.


Bit 1 **UDIS** : Update disable

This bit is set and cleared by software to enable/disable update event (UEV) generation.
0: UEV enabled. An UEV is generated by one of the following events:

– Counter overflow

–
Setting the UG bit
Buffered registers are then loaded with their preload values.
1: UEV disabled. No UEV is generated, shadow registers keep their value (ARR, PSC,
CCRx). The counter and the prescaler are reinitialized if the UG bit is set.


Bit 0 **CEN** : Counter enable

0: Counter disabled

1: Counter enabled

CEN is cleared automatically in one-pulse mode, when an update event occurs.


364/709 RM0041 Rev 6


**RM0041** **General-purpose timers (TIM12/13/14)**


**14.4.2** **TIM12 control register 2 (TIMx_CR2)**


Address offset: 0x04


Reset value: 0x0000

|15 14 13 12 11 10 9 8 7|6 5 4|Col3|Col4|3 2 1 0|
|---|---|---|---|---|
|Reserved|MMS[2:0]|MMS[2:0]|MMS[2:0]|Reserved|
|Reserved|rw|rw|rw|rw|



Bits 15:7 Reserved, must be kept at reset value.


Bits 6:4 **MMS[2:0]** : Master mode selection

These bits are used to select the information to be sent in Master mode to slave timers for

synchronization (TRGO). The combination is as follows:
000: **Reset**             - the UG bit in the TIMx_EGR register is used as the trigger output (TRGO). If
the reset is generated by the trigger input (slave mode controller configured in reset mode)
then the signal on TRGO is delayed compared to the actual reset.
001: **Enable**             - the Counter enable signal, CNT_EN, is used as the trigger output (TRGO). It
is useful to start several timers at the same time or to control a window in which a slave timer

is enabled. The Counter Enable signal is generated by a logic OR between the CEN control
bit and the trigger input when configured in Gated mode.
When the Counter Enable signal is controlled by the trigger input, there is a delay on TRGO,
except if the master/slave mode is selected (see the MSM bit description in the TIMx_SMCR
register).
010: **Update**             - The update event is selected as the trigger output (TRGO). For instance a
master timer can be used as a prescaler for a slave timer.
011: **Compare pulse**             - The trigger output sends a positive pulse when the CC1IF flag is to
be set (even if it was already high), as soon as a capture or a compare match occurs.
(TRGO).
100: **Compare**             - OC1REF signal is used as the trigger output (TRGO).
101: **Compare**             - OC2REF signal is used as the trigger output (TRGO).
110: Reserved

111: Reserved

_Note: The clock of the slave timer and ADC must be enabled prior to receiving events from_
_the master timer, and must not be changed on-the-fly while triggers are received from_
_the master timer._


Bits 3:0 Reserved, must be kept at reset value.


RM0041 Rev 6 365/709



455


**General-purpose timers (TIM12/13/14)** **RM0041**


**14.4.3** **TIM12 slave mode control register (TIMx_SMCR)**


Address offset: 0x08


Reset value: 0x0000

|15 14 13 12 11 10 9 8|7|6 5 4|Col4|Col5|3|2 1 0|Col8|Col9|
|---|---|---|---|---|---|---|---|---|
|Reserved|MSM|TS[2:0]|TS[2:0]|TS[2:0]|Res.|SMS[2:0]|SMS[2:0]|SMS[2:0]|
|Reserved|rw|rw|rw|rw|rw|rw|rw|rw|



Bits 15:8 Reserved, must be kept at reset value.


Bit 7 **MSM:** Master/Slave mode

0: No action

1: The effect of an event on the trigger input (TRGI) is delayed to allow a perfect
synchronization between the current timer and its slaves (through TRGO). It is useful in
order to synchronize several timers on a single external event.


Bits 6:4 **TS:** Trigger selection

This bit field selects the trigger input to be used to synchronize the counter.
000: Internal Trigger 0 (ITR0)
001: Internal Trigger 1 (ITR1)
010: Internal Trigger 2 (ITR2)
011: Internal Trigger 3 (ITR3)
100: TI1 Edge Detector (TI1F_ED)
101: Filtered Timer Input 1 (TI1FP1)
110: Filtered Timer Input 2 (TI2FP2)
111: Reserved.

See _Table 74: TIMx Internal trigger connection on page 367_ for more details on the meaning
of ITRx for each timer.

_Note: These bits must be changed only when they are not used (e.g. when SMS=’000’) to_
_avoid wrong edge detections at the transition._


366/709 RM0041 Rev 6


**RM0041** **General-purpose timers (TIM12/13/14)**


Bit 3 Reserved, must be kept at reset value.


Bits 2:0 **SMS:** Slave mode selection

When external signals are selected, the active edge of the trigger signal (TRGI) is linked to
the polarity selected on the external input (see Input control register and Control register
descriptions.
000: Slave mode disabled - if CEN = 1 then the prescaler is clocked directly by the internal
clock

001: Reserved

010: Reserved

011: Reserved

100: Reset mode - Rising edge of the selected trigger input (TRGI) reinitializes the counter
and generates an update of the registers
101: Gated mode - The counter clock is enabled when the trigger input (TRGI) is high. The
counter stops (but is not reset) as soon as the trigger becomes low. Counter starts and stops
are both controlled

110: Trigger mode - The counter starts on a rising edge of the trigger TRGI (but it is not
reset). Only the start of the counter is controlled
111: External clock mode 1 - Rising edges of the selected trigger (TRGI) clock the counter

_Note: The Gated mode must not be used if TI1F_ED is selected as the trigger input_
_(TS=’100’). Indeed, TI1F_ED outputs 1 pulse for each transition on TI1F, whereas the_
_Gated mode checks the level of the trigger signal._

_Note: The clock of the slave timer must be enabled prior to receive events from the master_
_timer, and must not be changed on-the-fly while triggers are received from the master_
_timer._


**Table 74. TIMx Internal trigger connection** **[(1)]**

|Slave TIM|ITR0 (TS = 000)|ITR1 (TS = 001)|ITR2 (TS = 010)|ITR3 (TS = 011)|
|---|---|---|---|---|
|TIM12|TIM4|TIM5|TIM13_OC|TIM14_OC|



1. When a timer is not present in the product, the corresponding trigger ITRx is not available.


**14.4.4** **TIM12 Interrupt enable register (TIMx_DIER)**


Address offset: 0x0C


Reset value: 0x0000

|15 14 13 12 11 10 9 8 7|6|5 4 3|2|1|0|
|---|---|---|---|---|---|
|Reserved|TIE|Res|CC2IE|CC1IE|UIE|
|Reserved|rw|rw|rw|rw|rw|



Bits 15:7 Reserved, must be kept at reset value.


Bit 6 **TIE** : Trigger interrupt enable

0: Trigger interrupt disabled.
1: Trigger interrupt enabled.


Bit 5:3 Reserved, must be kept at reset value.


RM0041 Rev 6 367/709



455


**General-purpose timers (TIM12/13/14)** **RM0041**


Bit 2 **CC2IE** : Capture/Compare 2 interrupt enable

0: CC2 interrupt disabled.
1: CC2 interrupt enabled.


Bit 1 **CC1IE** : Capture/Compare 1 interrupt enable

0: CC1 interrupt disabled.
1: CC1 interrupt enabled.


Bit 0 **UIE** : Update interrupt enable

0: Update interrupt disabled.
1: Update interrupt enabled.


368/709 RM0041 Rev 6


**RM0041** **General-purpose timers (TIM12/13/14)**


**14.4.5** **TIM12 status register (TIMx_SR)**


Address offset: 0x10


Reset value: 0x0000

|15 14 13 12 11|10|9|8 7|6|5 4 3|2|1|0|
|---|---|---|---|---|---|---|---|---|
|Reserved|CC2OF|CC1OF|Reserved|TIF|Reserved|CC2IF|CC1IF|UIF|
|Reserved|rc_w0|rc_w0|rc_w0|rc_w0|rc_w0|rc_w0|rc_w0|rc_w0|



Bits 15:11 Reserved, must be kept at reset value.


Bit 10 **CC2OF** : Capture/compare 2 overcapture flag

refer to CC1OF description


Bit 9 **CC1OF** : Capture/Compare 1 overcapture flag

This flag is set by hardware only when the corresponding channel is configured in input
capture mode. It is cleared by software by writing it to ‘0’.
0: No overcapture has been detected.
1: The counter value has been captured in TIMx_CCR1 register while CC1IF flag was
already set


Bits 8:7 Reserved, must be kept at reset value.


Bit 6 **TIF** : Trigger interrupt flag

This flag is set by hardware on trigger event (active edge detected on TRGI input when the
slave mode controller is enabled in all modes but gated mode. It is set when the counter
starts or stops when gated mode is selected. It is cleared by software.
0: No trigger event occurred.
1: Trigger interrupt pending.


Bits 5:3 Reserved, must be kept at reset value.


Bit 2 **CC2IF** : Capture/Compare 2 interrupt flag

refer to CC1IF description


Bit 1 **CC1IF** : Capture/compare 1 interrupt flag

**If channel CC1 is configured as output:**
This flag is set by hardware when the counter matches the compare value. It is cleared by
software.

0: No match.

1: The content of the counter TIMx_CNT matches the content of the TIMx_CCR1 register.
When the contents of TIMx_CCR1 are greater than the contents of TIMx_ARR, the CC1IF
bit goes high on the counter overflow.
**If channel CC1 is configured as input:**
This bit is set by hardware on a capture. It is cleared by software or by reading the
TIMx_CCR1 register.
0: No input capture occurred.
1: The counter value has been captured in TIMx_CCR1 register (an edge has been detected
on IC1 which matches the selected polarity).


RM0041 Rev 6 369/709



455


**General-purpose timers (TIM12/13/14)** **RM0041**


Bit 0 **UIF** : Update interrupt flag

This bit is set by hardware on an update event. It is cleared by software.
0: No update occurred.
1: Update interrupt pending. This bit is set by hardware when the registers are updated:

– At overflow and if UDIS=’0’ in the TIMx_CR1 register.

– When CNT is reinitialized by software using the UG bit in TIMx_EGR register, if URS=’0’ and
UDIS=’0’ in the TIMx_CR1 register.

– When CNT is reinitialized by a trigger event (refer to the synchro control register
description), if URS=’0’ and UDIS=’0’ in the TIMx_CR1 register.


**14.4.6** **TIM event generation register (TIMx_EGR)**


Address offset: 0x14


Reset value: 0x0000

|15 14 13 12 11 10 9 8 7|6|5 4 3|2|1|0|
|---|---|---|---|---|---|
|Reserved|TG|Reserved|CC2G|CC1G|UG|
|Reserved|w|w|w|w|w|



Bits 15:7 Reserved, must be kept at reset value.


Bit 6 **TG** : Trigger generation

This bit is set by software in order to generate an event, it is automatically cleared by
hardware.

0: No action

1: The TIF flag is set in the TIMx_SR register. Related interrupt can occur if enabled


Bits 5:3 Reserved, must be kept at reset value.


Bit 2 **CC2G** : Capture/compare 2 generation

refer to CC1G description


Bit 1 **CC1G** : Capture/compare 1 generation

This bit is set by software to generate an event, it is automatically cleared by hardware.
0: No action

1: A capture/compare event is generated on channel 1:
**If channel CC1 is configured as output:**
the CC1IF flag is set, the corresponding interrupt is sent if enabled.
**If channel CC1 is configured as input:**
The current counter value is captured in the TIMx_CCR1 register. The CC1IF flag is set, the
corresponding interrupt is sent if enabled. The CC1OF flag is set if the CC1IF flag was
already high.


Bit 0 **UG** : Update generation

This bit can be set by software, it is automatically cleared by hardware.
0: No action

1: Re-initializes the counter and generates an update of the registers. The prescaler counter
is also cleared and the prescaler ratio is not affected. The counter is cleared.


370/709 RM0041 Rev 6


**RM0041** **General-purpose timers (TIM12/13/14)**


**14.4.7** **TIM capture/compare mode register 1 (TIMx_CCMR1)**


Address offset: 0x18


Reset value: 0x0000


The channels can be used in input (capture mode) or in output (compare mode). The
direction of a channel is defined by configuring the corresponding CCxS bits. All the other
bits in this register have different functions in input and output modes. For a given bit, OCxx
describes its function when the channel is configured in output mode, ICxx describes its
function when the channel is configured in input mode. Take care that the same bit can have
different meanings for the input stage and the output stage.

|15|14 13 12|Col3|Col4|11|10|9 8|Col8|7|6 5 4|Col11|Col12|3|2|1 0|Col16|
|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|
|Res.|OC2M[2:0]|OC2M[2:0]|OC2M[2:0]|OC2PE|OC2FE|CC2S[1:0]|CC2S[1:0]|Res.|OC1M[2:0]|OC1M[2:0]|OC1M[2:0]|OC1PE|OC1FE|CC1S[1:0]|CC1S[1:0]|
|IC2F[3:0]|IC2F[3:0]|IC2F[3:0]|IC2F[3:0]|IC2PSC[1:0]|IC2PSC[1:0]|IC2PSC[1:0]|IC2PSC[1:0]|IC1F[3:0]|IC1F[3:0]|IC1F[3:0]|IC1F[3:0]|IC1PSC[1:0]|IC1PSC[1:0]|IC1PSC[1:0]|IC1PSC[1:0]|
|rw|rw|rw|rw|rw|rw|rw|rw|rw|rw|rw|rw|rw|rw|rw|rw|



**Output compare mode**


Bit 15 Reserved, must be kept at reset value.


Bits 14:12 **OC2M[2:0]** : Output compare 2 mode


Bit 11 **OC2PE** : Output compare 2 preload enable


Bit 10 **OC2FE** : Output compare 2 fast enable


Bits 9:8 **CC2S[1:0]** : Capture/Compare 2 selection

This bitfield defines the direction of the channel (input/output) as well as the used input.
00: CC2 channel is configured as output
01: CC2 channel is configured as input, IC2 is mapped on TI2
10: CC2 channel is configured as input, IC2 is mapped on TI1
11: CC2 channel is configured as input, IC2 is mapped on TRC. This mode works only if an
internal trigger input is selected through the TS bit (TIMx_SMCR register

_Note: The CC2S bits are writable only when the channel is OFF (CC2E = 0 in TIMx_CCER)._


Bit 7 Reserved, must be kept at reset value.


RM0041 Rev 6 371/709



455


**General-purpose timers (TIM12/13/14)** **RM0041**


Bits 6:4 **OC1M** : Output compare 1 mode

These bits define the behavior of the output reference signal OC1REF from which OC1 and
OC1N are derived. OC1REF is active high whereas the active levels of OC1 and OC1N
depend on the CC1P and CC1NP bits, respectively.
000: Frozen - The comparison between the output compare register TIMx_CCR1 and the
counter TIMx_CNT has no effect on the outputs.(this mode is used to generate a timing
base).
001: Set channel 1 to active level on match. The OC1REF signal is forced high when the
TIMx_CNT counter matches the capture/compare register 1 (TIMx_CCR1).
010: Set channel 1 to inactive level on match. The OC1REF signal is forced low when the
TIMx_CNT counter matches the capture/compare register 1 (TIMx_CCR1).
011: Toggle - OC1REF toggles when TIMx_CNT=TIMx_CCR1
100: Force inactive level - OC1REF is forced low

101: Force active level - OC1REF is forced high
110: PWM mode 1 - In upcounting, channel 1 is active as long as TIMx_CNT<TIMx_CCR1
else it is inactive. In downcounting, channel 1 is inactive (OC1REF=‘0) as long as
TIMx_CNT>TIMx_CCR1, else it is active (OC1REF=’1’)
111: PWM mode 2 - In upcounting, channel 1 is inactive as long as TIMx_CNT<TIMx_CCR1
else it is active. In downcounting, channel 1 is active as long as TIMx_CNT>TIMx_CCR1
else it is inactive.

_Note: In PWM mode 1 or 2, the OCREF level changes only when the result of the_
_comparison changes or when the output compare mode switches from “frozen” mode_
_to “PWM” mode._


Bit 3 **OC1PE** : Output compare 1 preload enable

0: Preload register on TIMx_CCR1 disabled. TIMx_CCR1 can be written at anytime, the
new value is taken into account immediately
1: Preload register on TIMx_CCR1 enabled. Read/Write operations access the preload
register. TIMx_CCR1 preload value is loaded into the active register at each update event


Bit 2 **OC1FE** : Output compare 1 fast enable

This bit is used to accelerate the effect of an event on the trigger in input on the CC output.
0: CC1 behaves normally depending on the counter and CCR1 values even when the
trigger is ON. The minimum delay to activate the CC1 output when an edge occurs on the
trigger input is 5 clock cycles
1: An active edge on the trigger input acts like a compare match on the CC1 output. Then,
OC is set to the compare level independently of the result of the comparison. Delay to
sample the trigger input and to activate CC1 output is reduced to 3 clock cycles. OC1FE
acts only if the channel is configured in PWM1 or PWM2 mode.


Bits 1:0 **CC1S** : Capture/Compare 1 selection

This bitfield defines the direction of the channel (input/output) as well as the used input.
00: CC1 channel is configured as output
01: CC1 channel is configured as input, IC1 is mapped on TI1
10: CC1 channel is configured as input, IC1 is mapped on TI2
11: CC1 channel is configured as input, IC1 is mapped on TRC. This mode works only if an
internal trigger input is selected through the TS bit (TIMx_SMCR register)

_Note: The CC1S bits are writable only when the channel is OFF (CC1E = 0 in TIMx_CCER)._


372/709 RM0041 Rev 6


**RM0041** **General-purpose timers (TIM12/13/14)**


**Input capture mode**


Bits 15:12 **IC2F** : Input capture 2 filter


Bits 11:10 **IC2PSC[1:0]** : Input capture 2 prescaler


Bits 9:8 **CC2S** : Capture/compare 2 selection

This bitfield defines the direction of the channel (input/output) as well as the used input.
00: CC2 channel is configured as output
01: CC2 channel is configured as input, IC2 is mapped on TI2
10: CC2 channel is configured as input, IC2 is mapped on TI1
11: CC2 channel is configured as input, IC2 is mapped on TRC. This mode works only if an
internal trigger input is selected through the TS bit (TIMx_SMCR register)

_Note: The CC2S bits are writable only when the channel is OFF (CC2E = 0 in TIMx_CCER)._


Bits 7:4 **IC1F** : Input capture 1 filter

This bitfield defines the frequency used to sample the TI1 input and the length of the digital
filter applied to TI1. The digital filter is made of an event counter in which N consecutive
events are needed to validate a transition on the output:
0000: No filter, sampling is done at f DTS
0001: f SAMPLING =f CK_INT, N=2
0010: f SAMPLING =f CK_INT, N=4
0011: f SAMPLING =f CK_INT, N=8
0100: f SAMPLING =f DTS /2, N=6
0101: f SAMPLING =f DTS /2, N=8
0110: f SAMPLING =f DTS /4, N=6
0111: f SAMPLING =f DTS /4, N=8
1000: f SAMPLING =f DTS /8, N=6
1001: f SAMPLING =f DTS /8, N=8
1010: f SAMPLING =f DTS /16, N=5
1011: f SAMPLING =f DTS /16, N=6
1100: f SAMPLING =f DTS /16, N=8
1101: f SAMPLING =f DTS /32, N=5
1110: f SAMPLING =f DTS /32, N=6
1111: f SAMPLING =f DTS /32, N=8


Bits 3:2 **IC1PSC** : Input capture 1 prescaler

This bitfield defines the ratio of the prescaler acting on the CC1 input (IC1).
The prescaler is reset as soon as CC1E=’0’ (TIMx_CCER register).
00: no prescaler, capture is done each time an edge is detected on the capture input
01: capture is done once every 2 events
10: capture is done once every 4 events
11: capture is done once every 8 events


Bits 1:0 **CC1S** : Capture/Compare 1 selection

This bitfield defines the direction of the channel (input/output) as well as the used input.
00: CC1 channel is configured as output
01: CC1 channel is configured as input, IC1 is mapped on TI1
10: CC1 channel is configured as input, IC1 is mapped on TI2
11: CC1 channel is configured as input, IC1 is mapped on TRC. This mode is working only if
an internal trigger input is selected through TS bit (TIMx_SMCR register)

_Note: The CC1S bits are writable only when the channel is OFF (CC1E = 0 in TIMx_CCER)._


RM0041 Rev 6 373/709



455


**General-purpose timers (TIM12/13/14)** **RM0041**


**14.4.8** **TIM12 capture/compare enable register (TIMx_CCER)**


Address offset: 0x20


Reset value: 0x0000

|15 14 13 12 11 10 9 8|7|6|5|4|3|2|1|0|
|---|---|---|---|---|---|---|---|---|
|Reserved|CC2NP|Res.|CC2P|CC2E|CC1NP|Res.|CC1P|CC1E|
|Reserved|rw|rw|rw|rw|rw|rw|rw|rw|



Bits 15:8 Reserved, must be kept at reset value.


Bit 7 **CC2NP** : Capture/Compare 2 output Polarity

refer to CC1NP description


Bits 6 Reserved, must be kept at reset value.


Bit 5 **CC2P** : Capture/Compare 2 output Polarity

refer to CC1P description


Bit 4 **CC2E** : Capture/Compare 2 output enable

refer to CC1E description


Bit 3 **CC1NP** : Capture/Compare 1 complementary output Polarity

CC1 channel configured as output: CC1NP must be kept cleared
CC1 channel configured as input: CC1NP is used in conjunction with CC1P to define
TI1FP1/TI2FP1 polarity (refer to CC1P description).


Bit 2 Reserved, must be kept at reset value.


Bit 1 **CC1P** : Capture/Compare 1 output Polarity _._

**CC1 channel configured as output:**
0: OC1 active high.
1: OC1 active low.

**CC1 channel configured as input:**
CC1NP/CC1P bits select TI1FP1 and TI2FP1 polarity for trigger or capture operations.
00: noninverted/rising edge
Circuit is sensitive to TIxFP1 rising edge (capture, trigger in reset, external clock or trigger
mode), TIxFP1 is not inverted (trigger in gated mode, encoder mode).
01: inverted/falling edge
Circuit is sensitive to TIxFP1 falling edge (capture, trigger in reset, external clock or trigger
mode), TIxFP1 is inverted (trigger in gated mode, encoder mode).
10: reserved, do not use this configuration.

_Note: 11: noninverted/both edges_
_Circuit is sensitive to both TIxFP1 rising and falling edges (capture, trigger in reset,_
_external clock or trigger mode), TIxFP1 is not inverted (trigger in gated mode). This_
_configuration must not be used for encoder mode._


Bit 0 **CC1E** : Capture/Compare 1 output enable _._

**CC1 channel configured as output:**
0: Off - OC1 is not active.

1: On - OC1 signal is output on the corresponding output pin.
**CC1 channel configured as input:**
This bit determines if a capture of the counter value can actually be done into the input
capture/compare register 1 (TIMx_CCR1) or not.
0: Capture disabled.
1: Capture enabled.


374/709 RM0041 Rev 6


**RM0041** **General-purpose timers (TIM12/13/14)**


**Table 75. Output control bit for standard OCx channels**

|CCxE bit|OCx output state|
|---|---|
|0|Output disabled (OCx=’0’, OCx_EN=’0’)|
|1|OCx=OCxREF + Polarity, OCx_EN=’1’|



_Note:_ _The states of the external I/O pins connected to the standard OCx channels depend on the_
_state of the OCx channel and on the GPIO registers._


**14.4.9** **TIM12 counter (TIMx_CNT)**


Address offset: 0x24


Reset value: 0x0000

|15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 0|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|Col10|Col11|Col12|Col13|Col14|Col15|Col16|
|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|
|CNT[15:0]|CNT[15:0]|CNT[15:0]|CNT[15:0]|CNT[15:0]|CNT[15:0]|CNT[15:0]|CNT[15:0]|CNT[15:0]|CNT[15:0]|CNT[15:0]|CNT[15:0]|CNT[15:0]|CNT[15:0]|CNT[15:0]|CNT[15:0]|
|rw|rw|rw|rw|rw|rw|rw|rw|rw|rw|rw|rw|rw|rw|rw|rw|



Bits 15:0 **CNT[15:0]** : Counter value


**14.4.10** **TIM12 prescaler (TIMx_PSC)**


Address offset: 0x28


Reset value: 0x0000

|15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 0|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|Col10|Col11|Col12|Col13|Col14|Col15|Col16|
|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|
|PSC[15:0]|PSC[15:0]|PSC[15:0]|PSC[15:0]|PSC[15:0]|PSC[15:0]|PSC[15:0]|PSC[15:0]|PSC[15:0]|PSC[15:0]|PSC[15:0]|PSC[15:0]|PSC[15:0]|PSC[15:0]|PSC[15:0]|PSC[15:0]|
|rw|rw|rw|rw|rw|rw|rw|rw|rw|rw|rw|rw|rw|rw|rw|rw|



Bits 15:0 **PSC[15:0]** : Prescaler value
The counter clock frequency CK_CNT is equal to f CK_PSC / (PSC[15:0] + 1).
PSC contains the value to be loaded in the active prescaler register at each update event
(including when the counter is cleared through UG bit of TIMx_EGR register or through
trigger controller when configured in “reset mode”).


**14.4.11** **TIM12 auto-reload register (TIMx_ARR)**


Address offset: 0x2C


Reset value: 0xFFFF

|15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 0|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|Col10|Col11|Col12|Col13|Col14|Col15|Col16|
|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|
|ARR[15:0]|ARR[15:0]|ARR[15:0]|ARR[15:0]|ARR[15:0]|ARR[15:0]|ARR[15:0]|ARR[15:0]|ARR[15:0]|ARR[15:0]|ARR[15:0]|ARR[15:0]|ARR[15:0]|ARR[15:0]|ARR[15:0]|ARR[15:0]|
|rw|rw|rw|rw|rw|rw|rw|rw|rw|rw|rw|rw|rw|rw|rw|rw|



Bits 15:0 **ARR[15:0]** : Auto-reload value

ARR is the value to be loaded into the actual auto-reload register.
Refer to the _Section 14.3.1: Time-base unit_ for more details about ARR update and
behavior.

The counter is blocked while the auto-reload value is null.


RM0041 Rev 6 375/709



455


**General-purpose timers (TIM12/13/14)** **RM0041**


**14.4.12** **TIM12 capture/compare register 1 (TIMx_CCR1)**


Address offset: 0x34


Reset value: 0x0000

|15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 0|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|Col10|Col11|Col12|Col13|Col14|Col15|Col16|
|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|
|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|
|rw/ro|rw/ro|rw/ro|rw/ro|rw/ro|rw/ro|rw/ro|rw/ro|rw/ro|rw/ro|rw/ro|rw/ro|rw/ro|rw/ro|rw/ro|rw/ro|



Bits 15:0 **CCR1[15:0]** : Capture/Compare 1 value

**If channel CC1 is configured as output** :
CCR1 is the value to be loaded into the actual capture/compare 1 register (preload value).
It is loaded permanently if the preload feature is not selected in the TIMx_CCMR1 register
(OC1PE bit). Else the preload value is copied into the active capture/compare 1 register
when an update event occurs.
The active capture/compare register contains the value to be compared to the TIMx_CNT
counter and signaled on the OC1 output.
**If channel CC1is configured as input** :
CCR1 is the counter value transferred by the last input capture 1 event (IC1). The
TIMx_CCR1 register is read-only and cannot be programmed.


**14.4.13** **TIM12 capture/compare register 2 (TIMx_CCR2)**


Address offset: 0x38


Reset value: 0x0000

|15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 0|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|Col10|Col11|Col12|Col13|Col14|Col15|Col16|
|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|
|CCR2[15:0]|CCR2[15:0]|CCR2[15:0]|CCR2[15:0]|CCR2[15:0]|CCR2[15:0]|CCR2[15:0]|CCR2[15:0]|CCR2[15:0]|CCR2[15:0]|CCR2[15:0]|CCR2[15:0]|CCR2[15:0]|CCR2[15:0]|CCR2[15:0]|CCR2[15:0]|
|rw/ro|rw/ro|rw/ro|rw/ro|rw/ro|rw/ro|rw/ro|rw/ro|rw/ro|rw/ro|rw/ro|rw/ro|rw/ro|rw/ro|rw/ro|rw/ro|



Bits 15:0 **CCR2[15:0]** : Capture/Compare 2 value

**If channel CC2 is configured as output:**
CCR2 is the value to be loaded into the actual capture/compare 2 register (preload value).
It is loaded permanently if the preload feature is not selected in the TIMx_CCMR2 register
(OC2PE bit). Else the preload value is copied into the active capture/compare 2 register
when an update event occurs.
The active capture/compare register contains the value to be compared to the TIMx_CNT
counter and signalled on the OC2 output.
**If channel CC2 is configured as input:**
CCR2 is the counter value transferred by the last input capture 2 event (IC2). The
TIMx_CCR2 register is read-only and cannot be programmed.


376/709 RM0041 Rev 6


**RM0041** **General-purpose timers (TIM12/13/14)**


**14.4.14** **TIM12 register map**


TIM12 registers are mapped as 16-bit addressable registers as described below. The
reserved memory areas are highlighted in gray in the table.


**Table 76. TIM12 register map and reset values**





























































































|Offset|Register|31|30|29|28|27|26|25|24|23|22|21|20|19|18|17|16|15|14|13|12|11|10|9|8|7|6|5|4|3|2|1|0|
|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|
|0x00|**TIMx_CR1**<br>Reset value|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|CKD<br>[1:0]<br>0<br>0|CKD<br>[1:0]<br>0<br>0|ARPE<br>0|Reserved|Reserved|Reserved|OPM<br>0|URS<br>0|UDIS<br>0|CEN<br>0|
|0x04|**TIMx_CR2**<br>Reset value|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|MMS[2:0]|MMS[2:0]|MMS[2:0]|Reserved|Reserved|Reserved|Reserved|
|0x04|**TIMx_CR2**<br>Reset value|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|0|0|0|0|0|0|0|
|0x08|**TIMx_SMCR**<br>Reset value|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|MSM<br>0|TS[2:0]<br>0<br>0<br>0|TS[2:0]<br>0<br>0<br>0|TS[2:0]<br>0<br>0<br>0|Reserved|SMS[2:0]<br>0<br>0<br>0|SMS[2:0]<br>0<br>0<br>0|SMS[2:0]<br>0<br>0<br>0|
|0x0C|**TIMx_DIER**<br>Reset value|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|TIE|Reserved|Reserved|Reserved|CC2IE|CC1IE|UIE|
|0x0C|**TIMx_DIER**<br>Reset value|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|0|0|0|0|0|0|0|
|0x10|**TIMx_SR**|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|CC2OF|CC1OF|Reserved|Reserved|TIF|Reserved|Reserved|Reserved|CC2IF|CC1IF|UIF|
|0x10|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|0|0|0|0|0|0|0|0|0|0|0|
|0x14|**TIMx_EGR**<br>Reset value|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|TG|Reserved|Reserved|Reserved|CC2G|CC1G|UG|
|0x14|**TIMx_EGR**<br>Reset value|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|0|0|0|0|0|0|0|
|0x18|**TIMx_CCMR1**<br>Output compare<br>mode<br>Reset value|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|OC2M<br>[2:0]<br>0<br>0<br>0|OC2M<br>[2:0]<br>0<br>0<br>0|OC2M<br>[2:0]<br>0<br>0<br>0|OC2PE<br>0|OC2FE<br>0|CC2S<br>[1:0]<br>0<br>0|CC2S<br>[1:0]<br>0<br>0|Reserved|OC1M<br>[2:0]<br>0<br>0<br>0|OC1M<br>[2:0]<br>0<br>0<br>0|OC1M<br>[2:0]<br>0<br>0<br>0|OC1PE<br>0|OC1FE<br>0|CC1<br>S <br>[1:0]<br>0<br>0|CC1<br>S <br>[1:0]<br>0<br>0|
|0x18|**TIMx_CCMR1**<br>Input capture<br>mode<br>Reset value|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|IC2F[3:0]<br>0<br>0<br>0<br>0|IC2F[3:0]<br>0<br>0<br>0<br>0|IC2F[3:0]<br>0<br>0<br>0<br>0|IC2F[3:0]<br>0<br>0<br>0<br>0|IC2<br>PSC<br>[1:0]<br>0<br>0|IC2<br>PSC<br>[1:0]<br>0<br>0|CC2S<br>[1:0]<br>0<br>0|CC2S<br>[1:0]<br>0<br>0|IC1F[3:0]<br>0<br>0<br>0<br>0|IC1F[3:0]<br>0<br>0<br>0<br>0|IC1F[3:0]<br>0<br>0<br>0<br>0|IC1F[3:0]<br>0<br>0<br>0<br>0|IC1<br>PSC<br>[1:0]<br>0<br>0|IC1<br>PSC<br>[1:0]<br>0<br>0|CC1<br>S <br>[1:0]<br>0<br>0|CC1<br>S <br>[1:0]<br>0<br>0|
|0x1C|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|
|0x20|**TIMx_CCER**<br>Reset value|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|CC2NP|Reserved|CC2P|CC2E|CC1NP|Reserved|CC1P|CC1E|
|0x20|**TIMx_CCER**<br>Reset value|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|0|0|0|0|0|0|0|0|
|0x24|**TIMx_CNT**<br>Reset value|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|CNT[15:0]|CNT[15:0]|CNT[15:0]|CNT[15:0]|CNT[15:0]|CNT[15:0]|CNT[15:0]|CNT[15:0]|CNT[15:0]|CNT[15:0]|CNT[15:0]|CNT[15:0]|CNT[15:0]|CNT[15:0]|CNT[15:0]|CNT[15:0]|
|0x24|**TIMx_CNT**<br>Reset value|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|
|0x28|**TIMx_PSC**<br>Reset value|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|PSC[15:0]|PSC[15:0]|PSC[15:0]|PSC[15:0]|PSC[15:0]|PSC[15:0]|PSC[15:0]|PSC[15:0]|PSC[15:0]|PSC[15:0]|PSC[15:0]|PSC[15:0]|PSC[15:0]|PSC[15:0]|PSC[15:0]|PSC[15:0]|
|0x28|**TIMx_PSC**<br>Reset value|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|
|0x2C|**TIMx_ARR**<br>Reset value|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|ARR[15:0]|ARR[15:0]|ARR[15:0]|ARR[15:0]|ARR[15:0]|ARR[15:0]|ARR[15:0]|ARR[15:0]|ARR[15:0]|ARR[15:0]|ARR[15:0]|ARR[15:0]|ARR[15:0]|ARR[15:0]|ARR[15:0]|ARR[15:0]|
|0x2C|**TIMx_ARR**<br>Reset value|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|
|0x30|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|


RM0041 Rev 6 377/709



455


**General-purpose timers (TIM12/13/14)** **RM0041**


**Table 76. TIM12 register map and reset values (continued)**













|Offset|Register|31|30|29|28|27|26|25|24|23|22|21|20|19|18|17|16|15|14|13|12|11|10|9|8|7|6|5|4|3|2|1|0|
|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|
|0x34|**TIMx_CCR1**<br>Reset value|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|
|0x34|**TIMx_CCR1**<br>Reset value|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|
|0x38|**TIMx_CCR2**<br>Reset value|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|CCR2[15:0]|CCR2[15:0]|CCR2[15:0]|CCR2[15:0]|CCR2[15:0]|CCR2[15:0]|CCR2[15:0]|CCR2[15:0]|CCR2[15:0]|CCR2[15:0]|CCR2[15:0]|CCR2[15:0]|CCR2[15:0]|CCR2[15:0]|CCR2[15:0]|CCR2[15:0]|
|0x38|**TIMx_CCR2**<br>Reset value|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|
|0x3C to<br>0x4C|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|


Refer to for the register boundary addresses.


378/709 RM0041 Rev 6


**RM0041** **General-purpose timers (TIM12/13/14)**

## **14.5 TIM13/14 registers**


The peripheral registers have to be written by half-words (16 bits) or words (32 bits). Read
accesses can be done by bytes (8 bits), half-words (16 bits) or words (32 bits).


**14.5.1** **TIM13/14 control register 1 (TIMx_CR1)**


Address offset: 0x00


Reset value: 0x0000

|15 14 13 12 11 10|9 8|Col3|7|6 5 4|3|2|1|0|
|---|---|---|---|---|---|---|---|---|
|Reserved|CKD[1:0]|CKD[1:0]|ARPE|Reserved|OPM|URS|UDIS|CEN|
|Reserved|rw|rw|rw|rw|rw|rw|rw|rw|



Bits 15:10 Reserved, must be kept at reset value.


Bits 9:8 **CKD** : Clock division

This bit-field indicates the division ratio between the timer clock (CK_INT) frequency and
sampling clock used by the digital filters (TIx),
00: t DTS = t CK_INT
01: t DTS = 2 × t CK_INT
10: t DTS = 4 × t CK_INT
11: Reserved


Bit 7 **ARPE** : Auto-reload preload enable

0: TIMx_ARR register is not buffered
1: TIMx_ARR register is buffered


Bits 6:4 Reserved, must be kept at reset value.


Bit 3 **OPM** : One-pulse mode

0: Counter is not stopped on the update event
1: Counter stops counting on the next update event (clearing the CEN bit).


Bit 2 **URS** : Update request source

This bit is set and cleared by software to select the update interrupt (UEV) sources.
0: Any of the following events generate an UEV if enabled:

– Counter overflow

–
Setting the UG bit
1: Only counter overflow generates an UEV if enabled.


Bit 1 **UDIS** : Update disable

This bit is set and cleared by software to enable/disable update interrupt (UEV) event
generation.
0: UEV enabled. An UEV is generated by one of the following events:

– Counter overflow

–
Setting the UG bit.
Buffered registers are then loaded with their preload values.
1: UEV disabled. No UEV is generated, shadow registers keep their value (ARR, PSC,
CCRx). The counter and the prescaler are reinitialized if the UG bit is set.


Bit 0 **CEN** : Counter enable

0: Counter disabled

1: Counter enabled


RM0041 Rev 6 379/709



455


**General-purpose timers (TIM12/13/14)** **RM0041**


**14.5.2** **TIM10/11/13/14 Interrupt enable register (TIMx_DIER)**


Address offset: 0x0C


Reset value: 0x0000

|15 14 13 12 11 10 9 8 7 6 5 4 3 2|1|0|
|---|---|---|
|Reserved|CC1IE|UIE|
|Reserved|rw|rw|



Bits 15:2 Reserved, must be kept at reset value.


Bit 1 **CC1IE** : Capture/Compare 1 interrupt enable

0: CC1 interrupt disabled
1: CC1 interrupt enabled


Bit 0 **UIE** : Update interrupt enable

0: Update interrupt disabled
1: Update interrupt enabled


**14.5.3** **TIM13/14 status register (TIMx_SR)**


Address offset: 0x10


Reset value: 0x0000

|15 14 13 12 11 10|9|8 7 6 5 4 3 2|1|0|
|---|---|---|---|---|
|Reserved|CC1OF|Reserved|CC1IF|UIF|
|Reserved|rc_w0|rc_w0|rc_w0|rc_w0|



Bits 15:10 Reserved, must be kept at reset value.


Bit 9 **CC1OF** : Capture/Compare 1 overcapture flag

This flag is set by hardware only when the corresponding channel is configured in input
capture mode. It is cleared by software by writing it to ‘0’.
0: No overcapture has been detected.
1: The counter value has been captured in TIMx_CCR1 register while CC1IF flag was
already set


Bits 8:2 Reserved, must be kept at reset value.


Bit 1 **CC1IF** : Capture/compare 1 interrupt flag

**If channel CC1 is configured as output:**
This flag is set by hardware when the counter matches the compare value. It is cleared by
software.

0: No match.

1: The content of the counter TIMx_CNT matches the content of the TIMx_CCR1 register.
When the contents of TIMx_CCR1 are greater than the contents of TIMx_ARR, the CC1IF bit
goes high on the counter overflow.
If channel CC1 is configured as input:
This bit is set by hardware on a capture. It is cleared by software or by reading the
TIMx_CCR1 register.
0: No input capture occurred.
1: The counter value has been captured in TIMx_CCR1 register (an edge has been detected
on IC1 which matches the selected polarity).


380/709 RM0041 Rev 6


**RM0041** **General-purpose timers (TIM12/13/14)**


Bit 0 **UIF** : Update interrupt flag

This bit is set by hardware on an update event. It is cleared by software.
0: No update occurred.
1: Update interrupt pending. This bit is set by hardware when the registers are updated:

–
At overflow and if UDIS=’0’ in the TIMx_CR1 register.

–
When CNT is reinitialized by software using the UG bit in TIMx_EGR register, if
URS=’0’ and UDIS=’0’ in the TIMx_CR1 register.


**14.5.4** **TIM13/14 event generation register (TIMx_EGR)**


Address offset: 0x14


Reset value: 0x0000

|15 14 13 12 11 10 9 8 7 6 5 4 3 2|1|0|
|---|---|---|
|Reserved|CC1G|UG|
|Reserved|w|w|



Bits 15:2 Reserved, must be kept at reset value.


Bit 1 **CC1G** : Capture/compare 1 generation

This bit is set by software in order to generate an event, it is automatically cleared by
hardware.

0: No action

1: A capture/compare event is generated on channel 1:
**If channel CC1 is configured as output:**
CC1IF flag is set, Corresponding interrupt or is sent if enabled.
**If channel CC1 is configured as input:**
The current value of the counter is captured in TIMx_CCR1 register. The CC1IF flag is set,
the corresponding interrupt is sent if enabled. The CC1OF flag is set if the CC1IF flag was
already high.


Bit 0 **UG** : Update generation

This bit can be set by software, it is automatically cleared by hardware.
0: No action

1: Re-initialize the counter and generates an update of the registers. Note that the prescaler
counter is cleared too (anyway the prescaler ratio is not affected). The counter is cleared.


**14.5.5** **TIM13/14 capture/compare mode register 1 (TIMx_CCMR1)**


Address offset: 0x18


Reset value: 0x0000


The channels can be used in input (capture mode) or in output (compare mode). The
direction of a channel is defined by configuring the corresponding CCxS bits. All the other
bits of this register have a different function in input and in output mode. For a given bit,
OCxx describes its function when the channel is configured in output, ICxx describes its
function when the channel is configured in input. So take care that the same bit can have a
different meaning for the input stage and for the output stage.

|15 14 13 12 11 10 9 8 7|Col2|6 5 4|Col4|Col5|3|2|1 0|Col9|
|---|---|---|---|---|---|---|---|---|
|Reserved|Reserved|OC1M[2:0]|OC1M[2:0]|OC1M[2:0]|OC1PE|OC1FE|CC1S[1:0]|CC1S[1:0]|
|Reserved|IC1F[3:0]|IC1F[3:0]|IC1F[3:0]|IC1F[3:0]|IC1PSC[1:0]|IC1PSC[1:0]|IC1PSC[1:0]|IC1PSC[1:0]|
|Reserved|rw|rw|rw|rw|rw|rw|rw|rw|



RM0041 Rev 6 381/709



455


**General-purpose timers (TIM12/13/14)** **RM0041**


**Output compare mode**


Bits 15:7 Reserved, must be kept at reset value.


Bits 6:4 **OC1M** : Output compare 1 mode

These bits define the behavior of the output reference signal OC1REF from which OC1 is
derived. OC1REF is active high whereas OC1 active level depends on CC1P bit.
000: Frozen. The comparison between the output compare register TIMx_CCR1 and the
counter TIMx_CNT has no effect on the outputs.
001: Set channel 1 to active level on match. OC1REF signal is forced high when the counter
TIMx_CNT matches the capture/compare register 1 (TIMx_CCR1).
010: Set channel 1 to inactive level on match. OC1REF signal is forced low when the
counter TIMx_CNT matches the capture/compare register 1 (TIMx_CCR1).
011: Toggle - OC1REF toggles when TIMx_CNT = TIMx_CCR1.

100: Force inactive level - OC1REF is forced low.

101: Force active level - OC1REF is forced high.
110: PWM mode 1 - Channel 1 is active as long as TIMx_CNT < TIMx_CCR1 else inactive.
111: PWM mode 2 - Channel 1 is inactive as long as TIMx_CNT < TIMx_CCR1 else active.

_Note: In PWM mode 1 or 2, the OCREF level changes when the result of the comparison_
_changes or when the output compare mode switches from frozen to PWM mode._


Bit 3 **OC1PE** : Output compare 1 preload enable

0: Preload register on TIMx_CCR1 disabled. TIMx_CCR1 can be written at anytime, the
new value is taken in account immediately.
1: Preload register on TIMx_CCR1 enabled. Read/Write operations access the preload
register. TIMx_CCR1 preload value is loaded in the active register at each update event.


Bit 2 **OC1FE** : Output compare 1 fast enable

This bit is used to accelerate the effect of an event on the trigger in input on the CC output.
0: CC1 behaves normally depending on counter and CCR1 values even when the trigger is
ON. The minimum delay to activate CC1 output when an edge occurs on the trigger input is
5 clock cycles.
1: An active edge on the trigger input acts like a compare match on CC1 output. OC is then
set to the compare level independently of the result of the comparison. Delay to sample the
trigger input and to activate CC1 output is reduced to 3 clock cycles. OC1FE acts only if the
channel is configured in PWM1 or PWM2 mode.


Bits 1:0 **CC1S** : Capture/Compare 1 selection

This bit-field defines the direction of the channel (input/output) as well as the used input.
00: CC1 channel is configured as output.
01: CC1 channel is configured as input, IC1 is mapped on TI1.
10: Reserved

11: Reserved

_Note: CC1S bits are writable only when the channel is OFF (CC1E = 0 in TIMx_CCER)._


382/709 RM0041 Rev 6


**RM0041** **General-purpose timers (TIM12/13/14)**


**Input capture mode**


Bits 15:8 Reserved, must be kept at reset value.


Bits 7:4 **IC1F** : Input capture 1 filter

This bit-field defines the frequency used to sample TI1 input and the length of the digital filter
applied to TI1. The digital filter is made of an event counter in which N consecutive events
are needed to validate a transition on the output:
0000: No filter, sampling is done at f DTS
0001: f SAMPLING =f CK_INT, N=2
0010: f SAMPLING =f CK_INT, N=4
0011: f SAMPLING =f CK_INT, N=8
0100: f SAMPLING =f DTS /2, N=6
0101: f SAMPLING =f DTS /2, N=8
0110: f SAMPLING =f DTS /4, N=6
0111: f SAMPLING =f DTS /4, N=8
1000: f SAMPLING =f DTS /8, N=6
1001: f SAMPLING =f DTS /8, N=8
1010: f SAMPLING =f DTS /16, N=5
1011: f SAMPLING =f DTS /16, N=6
1100: f SAMPLING =f DTS /16, N=8
1101: f SAMPLING =f DTS /32, N=5
1110: f SAMPLING =f DTS /32, N=6
1111: f SAMPLING =f DTS /32, N=8


Bits 3:2 **IC1PSC** : Input capture 1 prescaler

This bit-field defines the ratio of the prescaler acting on CC1 input (IC1).
The prescaler is reset as soon as CC1E=’0’ (TIMx_CCER register).
00: no prescaler, capture is done each time an edge is detected on the capture input
01: capture is done once every 2 events
10: capture is done once every 4 events
11: capture is done once every 8 events


Bits 1:0 **CC1S** : Capture/Compare 1 selection

This bit-field defines the direction of the channel (input/output) as well as the used input.
00: CC1 channel is configured as output
01: CC1 channel is configured as input, IC1 is mapped on TI1
10:

11:

_Note: CC1S bits are writable only when the channel is OFF (CC1E = 0 in TIMx_CCER)._


RM0041 Rev 6 383/709



455


**General-purpose timers (TIM12/13/14)** **RM0041**


**14.5.6** **TIM13/14 capture/compare enable register (TIMx_CCER)**


Address offset: 0x20


Reset value: 0x0000

|15 14 13 12 11 10 9 8 7 6 5 4|3|2|1|0|
|---|---|---|---|---|
|Reserved|CC1NP|Res.|CC1P|CC1E|
|Reserved|rw|rw|rw|rw|



Bits 15:4 Reserved, must be kept at reset value.


Bit 3 **CC1NP** : Capture/Compare 1 complementary output Polarity.

CC1 channel configured as output: CC1NP must be kept cleared.
CC1 channel configured as input: CC1NP bit is used in conjunction with CC1P to define
TI1FP1 polarity (refer to CC1P description).


Bit 2 Reserved, must be kept at reset value.


Bit 1 **CC1P** : Capture/Compare 1 output Polarity.

**CC1 channel configured as output:**
0: OC1 active high
1: OC1 active low

**CC1 channel configured as input:**
The CC1P bit selects TI1FP1 and TI2FP1 polarity for trigger or capture operations.
00: noninverted/rising edge
Circuit is sensitive to TI1FP1 rising edge (capture mode), TI1FP1 is not inverted.
01: inverted/falling edge
Circuit is sensitive to TI1FP1 falling edge (capture mode), TI1FP1 is inverted.
10: reserved, do not use this configuration.
11: noninverted/both edges
Circuit is sensitive to both TI1FP1 rising and falling edges (capture mode), TI1FP1 is not
inverted.


Bit 0 **CC1E** : Capture/Compare 1 output enable.

**CC1 channel configured as output:**
0: Off - OC1 is not active

1: On - OC1 signal is output on the corresponding output pin
**CC1 channel configured as input:**
This bit determines if a capture of the counter value can actually be done into the input
capture/compare register 1 (TIMx_CCR1) or not.
0: Capture disabled
1: Capture enabled


**Table 77. Output control bit for standard OCx channels**

|CCxE bit|OCx output state|
|---|---|
|0|Output Disabled (OCx=’0’, OCx_EN=’0’)|
|1|OCx=OCxREF + Polarity, OCx_EN=’1’|



_Note:_ _The state of the external I/O pins connected to the standard OCx channels depends on the_
_OCx channel state and the GPIO registers._


384/709 RM0041 Rev 6


**RM0041** **General-purpose timers (TIM12/13/14)**


**14.5.7** **TIM13/14 counter (TIMx_CNT)**


Address offset: 0x24


Reset value: 0x0000

|15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 0|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|Col10|Col11|Col12|Col13|Col14|Col15|Col16|
|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|
|CNT[15:0]|CNT[15:0]|CNT[15:0]|CNT[15:0]|CNT[15:0]|CNT[15:0]|CNT[15:0]|CNT[15:0]|CNT[15:0]|CNT[15:0]|CNT[15:0]|CNT[15:0]|CNT[15:0]|CNT[15:0]|CNT[15:0]|CNT[15:0]|
|rw|rw|rw|rw|rw|rw|rw|rw|rw|rw|rw|rw|rw|rw|rw|rw|



Bits 15:0 **CNT[15:0]** : Counter value


**14.5.8** **TIM13/14 prescaler (TIMx_PSC)**


Address offset: 0x28


Reset value: 0x0000

|15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 0|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|Col10|Col11|Col12|Col13|Col14|Col15|Col16|
|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|
|PSC[15:0]|PSC[15:0]|PSC[15:0]|PSC[15:0]|PSC[15:0]|PSC[15:0]|PSC[15:0]|PSC[15:0]|PSC[15:0]|PSC[15:0]|PSC[15:0]|PSC[15:0]|PSC[15:0]|PSC[15:0]|PSC[15:0]|PSC[15:0]|
|rw|rw|rw|rw|rw|rw|rw|rw|rw|rw|rw|rw|rw|rw|rw|rw|



Bits 15:0 **PSC[15:0]** : Prescaler value
The counter clock frequency CK_CNT is equal to f CK_PSC / (PSC[15:0] + 1).
PSC contains the value to be loaded in the active prescaler register at each update event
(including when the counter is cleared through UG bit of TIMx_EGR register or through
trigger controller when configured in “reset mode”).


**14.5.9** **TIM13/14 auto-reload register (TIMx_ARR)**


Address offset: 0x2C


Reset value: 0xFFFF

|15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 0|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|Col10|Col11|Col12|Col13|Col14|Col15|Col16|
|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|
|ARR[15:0]|ARR[15:0]|ARR[15:0]|ARR[15:0]|ARR[15:0]|ARR[15:0]|ARR[15:0]|ARR[15:0]|ARR[15:0]|ARR[15:0]|ARR[15:0]|ARR[15:0]|ARR[15:0]|ARR[15:0]|ARR[15:0]|ARR[15:0]|
|rw|rw|rw|rw|rw|rw|rw|rw|rw|rw|rw|rw|rw|rw|rw|rw|



Bits 15:0 **ARR[15:0]** : Auto-reload value
ARR is the value to be loaded in the actual auto-reload register.

Refer to _Section 14.3.1: Time-base unit_ for more details about ARR update and behavior.

The counter is blocked while the auto-reload value is null.


RM0041 Rev 6 385/709



455


**General-purpose timers (TIM12/13/14)** **RM0041**


**14.5.10** **TIM13/14 capture/compare register 1 (TIMx_CCR1)**


Address offset: 0x34


Reset value: 0x0000

|15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 0|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|Col10|Col11|Col12|Col13|Col14|Col15|Col16|
|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|
|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|
|rw/ro|rw/ro|rw/ro|rw/ro|rw/ro|rw/ro|rw/ro|rw/ro|rw/ro|rw/ro|rw/ro|rw/ro|rw/ro|rw/ro|rw/ro|rw/ro|



Bits 15:0 **CCR1[15:0]** : Capture/Compare 1 value

**If channel CC1 is configured as output** :
CCR1 is the value to be loaded in the actual capture/compare 1 register (preload value).

It is loaded permanently if the preload feature is not selected in the TIMx_CCMR1 register (bit
OC1PE). Else the preload value is copied in the active capture/compare 1 register when an
update event occurs.

The active capture/compare register contains the value to be compared to the counter
TIMx_CNT and signaled on OC1 output.


**If channel CC1is configured as input** :
CCR1 is the counter value transferred by the last input capture 1 event (IC1). The TIMx_CCR1
register is read-only and cannot be programmed.


386/709 RM0041 Rev 6


**RM0041** **General-purpose timers (TIM12/13/14)**


**14.5.11** **TIM13/14 register map**


TIMx registers are mapped as 16-bit addressable registers as described in the table below.


**Table 78. TIM13/14 register map and reset values**









































































|Offset|Register|31|30|29|28|27|26|25|24|23|22|21|20|19|18|17|16|15|14|13|12|11|10|9|8|7|6|5|4|3|2|1|0|
|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|
|0x00|**TIMx_CR1**|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|CKD<br>[1:0]|CKD<br>[1:0]|ARPE|Reserve<br>d|Reserve<br>d|Reserve<br>d|OPM|URS|UDIS|CEN|
|0x00|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|0|0|0|0|0|0|0|0|0|0|
|0x08|**TIMx_SMCR**|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|
|0x08|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|
|0x0C|**TIMx_DIER**|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|CC1IE|UIE|
|0x0C|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|0|0|
|0x10|**TIMx_SR**|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|CC1OF|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|CC1IF|UIF|
|0x10|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|0|0|0|0|0|0|0|0|0|0|
|0x14|**TIMx_EGR**|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|CC1G|UG|
|0x14|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|0|0|
|0x18|**TIMx_CCMR1**<br>Output compare<br>mode|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|OC1M<br>[2:0]|OC1M<br>[2:0]|OC1M<br>[2:0]|OC1PE|OC1FE|CC1S<br>[1:0]|CC1S<br>[1:0]|
|0x18|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|0|0|0|0|0|0|0|
|0x18|**TIMx_CCMR1**<br>Input capture<br>mode|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|IC1F[3:0]|IC1F[3:0]|IC1F[3:0]|IC1F[3:0]|IC1<br>PSC<br>[1:0]|IC1<br>PSC<br>[1:0]|CC1S<br>[1:0]|CC1S<br>[1:0]|
|0x18|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|0|0|0|0|0|0|0|0|
|0x1C|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|
|0x20|**TIMx_CCER**|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|CC1NP|Reserved|CC1P|CC1E|
|0x20|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|0|0|0|0|
|0x24|**TIMx_CNT**|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|CNT[15:0]|CNT[15:0]|CNT[15:0]|CNT[15:0]|CNT[15:0]|CNT[15:0]|CNT[15:0]|CNT[15:0]|CNT[15:0]|CNT[15:0]|CNT[15:0]|CNT[15:0]|CNT[15:0]|CNT[15:0]|CNT[15:0]|CNT[15:0]|
|0x24|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|
|0x28|**TIMx_PSC**|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|PSC[15:0]|PSC[15:0]|PSC[15:0]|PSC[15:0]|PSC[15:0]|PSC[15:0]|PSC[15:0]|PSC[15:0]|PSC[15:0]|PSC[15:0]|PSC[15:0]|PSC[15:0]|PSC[15:0]|PSC[15:0]|PSC[15:0]|PSC[15:0]|
|0x28|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|
|0x2C|**TIMx_ARR**|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|ARR[15:0]|ARR[15:0]|ARR[15:0]|ARR[15:0]|ARR[15:0]|ARR[15:0]|ARR[15:0]|ARR[15:0]|ARR[15:0]|ARR[15:0]|ARR[15:0]|ARR[15:0]|ARR[15:0]|ARR[15:0]|ARR[15:0]|ARR[15:0]|
|0x2C|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|
|0x30|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|
|0x34|**TIMx_CCR1**|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|CCR1[15:0]|
|0x34|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|Reset value|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|
|0x38 to<br>0x4C|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|Reserved|


RM0041 Rev 6 387/709



455


